webpackJsonp([1],{KT4T:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("7+uW"),a={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]},r=n("VU/8")({name:"App"},a,!1,null,null,null).exports,s=n("/ocq"),l={data:function(){return{activeIndex:"",events:[]}},mounted:function(){this.activeIndex=sessionStorage.getItem("cronKeyPath")||"/cron/schedule"},watch:{activeIndex:function(e){e!=this.$route.path&&(this.activeIndex=this.$route.path)}},methods:{handleSelect:function(e,t){sessionStorage.setItem("cronKeyPath",e)}}},i={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-container",[n("el-header",{staticStyle:{padding:"0"}},[n("el-row",[n("el-menu",{attrs:{"default-active":e.activeIndex,mode:"horizontal",router:""},on:{select:e.handleSelect}},[n("el-menu-item",{attrs:{index:"/cron/schedule"}},[e._v(" Schedule ")]),e._v(" "),n("el-menu-item",{attrs:{index:"/cron/running"}},[e._v(" Running ")]),e._v(" "),n("el-menu-item",{attrs:{index:"/cron/dashboard",disabled:!0}},[e._v(" Dashboard ")])],1)],1)],1),e._v(" "),n("el-main",[n("router-view")],1)],1)],1)},staticRenderFns:[]},c=n("VU/8")(l,i,!1,null,null,null).exports,u=n("//Fk"),d=n.n(u),f=n("mtWM"),m=n("zL8q"),p=n.n(m),h=f.a.create({baseURL:"http://localhost:8080/api",timeout:3e3});function b(){return h({url:"/v1/schedule",method:"get"})}function v(){return h({url:"/v1/jobs",method:"get"})}function g(e){if(0===e)return"";var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1>=10?t.getMonth()+1:"0"+(t.getMonth()+1))+"-"+(t.getDate()>=10?t.getDate():"0"+t.getDate())+" "+(t.getHours()>=10?t.getHours():"0"+t.getHours())+":"+(t.getMinutes()>=10?t.getMinutes():"0"+t.getMinutes())+":"+(t.getSeconds()>=10?t.getSeconds():"0"+t.getSeconds())}h.interceptors.response.use(function(e){var t=e.data;if(0!==t.code){var n="Internal Error: "+t.code;return console.error(t.code,t.msg),d.a.reject(n)}return t},function(e){return console.error(e.message),d.a.reject(e)});var _={data:function(){return{events:[],jobs:[],search:"",dialogFormVisible:!1,options:[],loading:!1,addForm:{job:"",spec:""}}},created:function(){var e=this;d.a.all([b(),v()]).then(function(t){e.events=t[0].data,e.jobs=t[1].data}).catch(function(t){e.$message.error(t)})},methods:{fetchSchedule:function(){var e=this;b().then(function(t){e.events=t.data})},toggleJobStatus:function(e){var t,n=this;e.displayed?(t=e.name,h({url:"/v1/active",method:"get",params:{job:t}})).catch(function(t){e.displayed=!1,n.$message.error(t)}):function(e){return h({url:"/v1/pause",method:"get",params:{job:e}})}(e.name).catch(function(t){e.displayed=!0,n.$message.error(t)})},removeJob:function(e,t){var n=this;this.$confirm("This will permanently remove the job "+t.name+", continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"cancel",type:"warning"}).then(function(){var o;(o=t.name,h({url:"/v1/remove",method:"get",params:{job:o}})).then(function(){n.events.splice(e,1),n.$message.success("Delete completed")}).catch(function(e){n.$message.error(e)})}).catch(function(){})},execute:function(e){var t=this;this.$confirm("This will immediately run the job "+e.name+", continue?","Info",{confirmButtonText:"OK",cancelButtonText:"cancel",type:"info"}).then(function(){var n;(n=e.name,h({url:"/v1/execute",method:"get",params:{job:n}})).then(function(){t.$message.success("Run completed")}).catch(function(e){t.$message.error(e)})}).catch(function(){})},optionalJobs:function(e){var t=this;""!==e?(this.loading=!0,setTimeout(function(){t.loading=!1,t.options=t.jobs.filter(function(n){return t.isSubString(n,e)})},200)):this.options=[]},isSubString:function(e,t){return!t||e.toLowerCase().includes(t.toLowerCase())},onSubmit:function(){var e,t,n=this;this.dialogFormVisible=!1,(e=this.addForm.spec,t=this.addForm.job,h({url:"/v1/add",method:"get",params:{spec:e,job:t}})).then(function(){n.$message.success("add completed"),n.fetchSchedule()}).catch(function(e){n.$message.error(e)})},timeFormatter:function(e,t,n,o){return g(n)}}},y={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",[n("el-header",[n("el-row",{attrs:{gutter:10}},[n("el-col",{attrs:{xs:{span:22,offset:1},sm:{span:20,offset:2},md:{span:18,offset:3},lg:{span:14,offset:5},xl:{span:8,offset:8}}},[n("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"Type to search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[n("el-button",{staticStyle:{color:"#409EFF"},attrs:{slot:"append",icon:"el-icon-circle-plus"},on:{click:function(t){e.dialogFormVisible=!0}},slot:"append"})],1)],1)],1),e._v(" "),n("el-dialog",{attrs:{title:"Add job schedule",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[n("el-form",{attrs:{model:e.addForm,"label-width":"50px"}},[n("el-form-item",{attrs:{label:"Job"}},[n("el-select",{staticStyle:{display:"block"},attrs:{filterable:"",remote:"",placeholder:"Please enter a job","remote-method":e.optionalJobs,loading:e.loading},model:{value:e.addForm.job,callback:function(t){e.$set(e.addForm,"job",t)},expression:"addForm.job"}},e._l(e.options,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"Spec"}},[n("el-input",{attrs:{autocomplete:"off",placeholder:"@every 30s"},model:{value:e.addForm.spec,callback:function(t){e.$set(e.addForm,"spec",t)},expression:"addForm.spec"}})],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("cancel")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("confirm")])],1)],1)],1),e._v(" "),n("el-main",[n("el-row",{attrs:{gutter:10}},[n("el-col",{attrs:{xs:{span:22,offset:1},sm:{span:20,offset:2},md:{span:18,offset:3},lg:{span:14,offset:5},xl:{span:8,offset:8}}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.events.filter(function(t){return e.isSubString(t.name,e.search)}),stripe:""}},[n("template",{slot:"empty"},[n("el-empty",{attrs:{"image-size":100,description:"No Data"}})],1),e._v(" "),n("el-table-column",{attrs:{label:"Job",prop:"name",width:"100%",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("router-link",{staticStyle:{color:"#409EFF"},attrs:{to:{path:"/cron/history",query:{job:t.row.name}}}},[e._v("\n                "+e._s(t.row.name)+"\n              ")])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"Next Execution",prop:"next",formatter:e.timeFormatter,sortable:""}}),e._v(" "),n("el-table-column",{attrs:{label:"Spec",prop:"spec"}}),e._v(" "),n("el-table-column",{attrs:{label:"Status"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-switch",{on:{change:function(n){return e.toggleJobStatus(t.row)}},model:{value:t.row.displayed,callback:function(n){e.$set(t.row,"displayed",n)},expression:"scope.row.displayed"}})]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"Actions",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{plain:"",size:"mini",icon:"el-icon-video-play",type:"primary"},on:{click:function(n){return e.execute(t.row)}}}),e._v(" "),n("el-button",{attrs:{plain:"",size:"mini",icon:"el-icon-delete",type:"danger"},on:{click:function(n){return e.removeJob(t.$index,t.row)}}})]}}])})],2)],1)],1)],1)],1)},staticRenderFns:[]},x=n("VU/8")(_,y,!1,null,null,null).exports,w={data:function(){return{executions:[]}},created:function(){this.fetchRunning()},methods:{fetchRunning:function(){var e=this;h({url:"/v1/running",method:"get"}).then(function(t){e.executions=t.data}).catch(function(t){e.$message.error(t)})},timeFormatter:function(e,t,n,o){return g(n)}}},F={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",[n("el-main",[n("el-row",{attrs:{gutter:10}},[n("el-col",{attrs:{xs:{span:22,offset:1},sm:{span:20,offset:2},md:{span:18,offset:3},lg:{span:14,offset:5},xl:{span:8,offset:8}}},[n("el-table",{attrs:{data:e.executions,stripe:""}},[n("template",{slot:"empty"},[n("el-empty",{attrs:{"image-size":100,description:"No Data"}})],1),e._v(" "),n("el-table-column",{attrs:{label:"Id",prop:"id","show-overflow-tooltip":!0}}),e._v(" "),n("el-table-column",{attrs:{label:"Job",prop:"name",width:"120%",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("router-link",{staticStyle:{color:"#409EFF"},attrs:{to:{path:"/cron/history",query:{job:t.row.name}}}},[e._v("\n                "+e._s(t.row.name)+"\n              ")])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"StartedAt",prop:"started_at",formatter:e.timeFormatter,sortable:""}}),e._v(" "),n("el-table-column",{attrs:{label:"Node",prop:"node","show-overflow-tooltip":!0}}),e._v(" "),n("el-table-column",{attrs:{label:"Status"}},[n("span",[n("i",{staticClass:"el-icon-loading",staticStyle:{"font-size":"1.5rem"}})])])],2)],1)],1)],1)],1)},staticRenderFns:[]},S=n("VU/8")(w,F,!1,null,null,null).exports,j={data:function(){return{jobs:[],members:[]}},created:function(){this.fetchJobs(),this.fetchMembers()},methods:{fetchJobs:function(){var e=this;v().then(function(t){console.log(t),e.jobs=t.data}).catch(function(e){})},fetchMembers:function(){var e=this;h({url:"/v1/members",method:"get"}).then(function(t){console.log(t),e.members=t.data})}}},$={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-container",[t("el-main",[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{xs:{span:22,offset:1},sm:{span:20,offset:2},md:{span:18,offset:3},lg:{span:14,offset:5},xl:{span:8,offset:8}}})],1)],1)],1)},staticRenderFns:[]},k=n("VU/8")(j,$,!1,null,null,null).exports,R={data:function(){return{executions:[]}},created:function(){this.fetchHistory(this.$route.query.job)},methods:{fetchHistory:function(e){var t=this;(function(e){return h({url:"/v1/history",method:"get",params:{job:e}})})(e).then(function(e){t.executions=e.data}).catch(function(e){t.$message.error(e)})},timeFormatter:function(e,t,n,o){return g(n)},consumeFormatter:function(e){return(t=(e.finished_at-e.started_at)/1e3)<=0?NaN:t<60?t+"s":t<3600?(t/60).toFixed(2)+"min":(t/3600).toFixed(2)+"h";var t}}},T={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",[n("el-main",[n("el-row",{attrs:{gutter:10}},[n("el-col",{attrs:{xs:{span:22,offset:1},sm:{span:20,offset:2},md:{span:18,offset:3},lg:{span:14,offset:5},xl:{span:8,offset:8}}})],1),e._v(" "),n("el-row",{attrs:{gutter:10}},[n("el-col",{attrs:{xs:{span:22,offset:1},sm:{span:20,offset:2},md:{span:18,offset:3},lg:{span:14,offset:5},xl:{span:8,offset:8}}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.executions,stripe:""}},[n("template",{slot:"empty"},[n("el-empty",{attrs:{"image-size":100,description:"No Data"}})],1),e._v(" "),n("el-table-column",{attrs:{label:"Id",prop:"id","show-overflow-tooltip":!0}}),e._v(" "),n("el-table-column",{attrs:{label:"StartedAt",prop:"started_at",formatter:e.timeFormatter}}),e._v(" "),n("el-table-column",{attrs:{label:"FinisheddAt",prop:"finished_at",formatter:e.timeFormatter}}),e._v(" "),n("el-table-column",{attrs:{label:"Node",prop:"node","show-overflow-tooltip":!0}}),e._v(" "),n("el-table-column",{attrs:{label:"Status",width:"80"},scopedSlots:e._u([{key:"default",fn:function(e){return[0===e.row.finished_at?n("span",[n("i",{staticClass:"el-icon-loading",attrs:{id:"hist-loading"}})]):!0===e.row.success?n("span",[n("i",{staticClass:"el-icon-success",attrs:{id:"hist-success"}})]):n("span",[n("i",{staticClass:"el-icon-error",attrs:{id:"hist-error"}})])]}}])}),e._v(" "),n("el-table-column",{attrs:{type:"expand",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[0!==t.row.finished_at?n("el-form",{staticClass:"table-expand",attrs:{"label-position":"left",block:""}},[n("el-form-item",{attrs:{label:"consume:"}},[n("span",[e._v(" "+e._s(e.consumeFormatter(t.row))+" ")])]),e._v(" "),n("el-form-item",{attrs:{label:"result:"}},[n("span",[e._v(e._s(t.row.result)+" ")])])],1):e._e()]}}])})],2)],1)],1)],1)],1)},staticRenderFns:[]};var J=n("VU/8")(R,T,!1,function(e){n("KT4T")},null,null).exports;o.default.use(s.a);var V=new s.a({routes:[{path:"/",name:"Cron",component:c,children:[{path:"/cron/schedule",name:"Schedule",component:x},{path:"/cron/running",name:"Running",component:S},{path:"/cron/dashboard",name:"Dashboard",component:k},{path:"/cron/history",name:"History",component:J}]}]});n("tvR6");o.default.config.productionTip=!1,o.default.use(p.a),new o.default({el:"#app",router:V,render:function(e){return e(r)}})},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.587eb8db79449561c642.js.map